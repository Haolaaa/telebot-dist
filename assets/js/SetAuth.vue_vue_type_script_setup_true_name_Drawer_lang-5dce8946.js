import{d as v,i as r,r as p,o as g,h as x,w as l,b as i,e as f,u as T,aI as A,aJ as C,aK as N,a5 as h,aL as V}from"./index-99d0a915.js";const M=v({name:"Drawer"}),P=v({...M,setup(L,{expose:y}){const o=r(!1),n=r({authorityID:0}),_=e=>{n.value=e,o.value=!0,w()},c=r(),d=r([]),m=r([]),k=r({children:"children",label:e=>e.meta.title}),w=async()=>{try{d.value=[];const{data:e}=await C({page:1,pageSize:1e3});m.value=e.menus;const{data:t}=await N({authorityID:n.value.authorityID}),a=t.menus,u=[];a&&a.forEach(s=>{a.some(b=>Number(b.parentID)===s.ID)||u.push(Number(s.ID))}),d.value=u}catch{h.error({message:"获取菜单列表失败！"})}},D=(e,t)=>e?t.meta.title.indexOf(e)!==-1:!0,I=async()=>{try{if(!c.value)return;const e=c.value.getCheckedNodes(!1,!0),t=await V({menus:e,authorityId:n.value.authorityID});h.success({message:"设置权限成功！"}),n.value.getTableList(),o.value=!1}catch{}};return y({acceptParams:_}),(e,t)=>{const a=p("el-button"),u=p("el-drawer");return g(),x(u,{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value=s),"destroy-on-close":!0,size:"450px",title:"设置权限"},{footer:l(()=>[i(a,{onClick:t[0]||(t[0]=s=>o.value=!1)},{default:l(()=>[f("取消")]),_:1}),i(a,{type:"primary",onClick:I},{default:l(()=>[f("确定")]),_:1})]),default:l(()=>[i(T(A),{ref_key:"menuTree",ref:c,data:m.value,"default-checked-keys":d.value,props:k.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"","filter-node-method":D},null,8,["data","default-checked-keys","props","filter-node-method"])]),_:1},8,["modelValue"])}}});export{P as _};

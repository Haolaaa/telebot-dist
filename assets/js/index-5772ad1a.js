import{A as r,C as d,d as T,B as h,r as k,o as v,e as A,f as t,w as o,g as c,j as x,h as a,D as E,E as L,F as S,G as H,l as O,m as I,H as l,I as M,J as C}from"./index-7dc4f2d9.js";import{_ as R}from"./index.vue_vue_type_script_setup_true_name_ProTable_lang-36752a68.js";import U from"./dialog-65395dd1.js";import{u as _}from"./useHandleData-9f2382d5.js";import"./_plugin-vue_export-helper-c27b6911.js";const W=n=>r.post(`${d}/list`,n),B=n=>r.post(`${d}/create`,n),F=n=>r.post(`${d}/delete`,n),P=n=>r.post(`${d}/update`,n),j=n=>r.post(`${d}/status`,n),q=n=>r.post(`${d}/execOnce`,n),G={class:"table-box"},V=T({name:"useProTable"}),X=T({...V,setup(n){const y=h(),p={perMonth:"每月",perWeek:"每周",perHour:"每小时",perNDay:"每隔 N 日",perDay:"每天",perNHour:"每隔 N 时",perNMinute:"每隔 N 分钟",perNSecond:"每隔 N 秒",per:"每隔",handle:"执行",day:"日",day1:"天",hour:"小时",minute:"分钟",second:"秒",monday:"周一",tuesday:"周二",wednesday:"周三",thursday:"周四",friday:"周五",saturday:"周六",sunday:"周日"},D=[{width:200,prop:"type",label:"任务类型",render({row:e}){return t("span",null,[e.type==="healthCheck"?"程序状态检测":"成人站资源检测"])}},{width:150,prop:"name",label:"任务名称"},{width:100,prop:"status",label:"状态",render({row:e}){return t(k("el-tag"),{type:e.status==="Enable"?"success":"danger"},{default:()=>[e.status==="Enable"?"启用":"禁用"]})}},{width:200,prop:"specType",label:"执行周期",render({row:e}){return t(C,null,[e.specType.indexOf("N")===-1||e.specType==="perWeek"?t("span",null,[p[e.specType]]):t("span",null,[p.per]),e.specType==="perMonth"&&t("span",null,[e.day,p.day,l(e.hour),a(" : "),l(e.minute)]),e.specType==="perWeek"&&t("span",null,[M(e.week),a(" "),l(e.hour),a(" : "),l(e.minute)]),e.specType==="perDay"&&t("span",null,[l(e.hour),a(" : "),l(e.minute)]),e.specType==="perNDay"&&t("span",null,[e.day,a(" "),p.day1,a(", "),l(e.hour),a(" :"),l(e.minute)]),e.specType==="perNHour"&&t("span",null,[e.hour,p.hour,e.minute!==0&&t(C,null,[a(", "),l(e.minute),a("分钟")])]),e.specType==="perHour"&&t("span",null,[l(e.minute)]),e.specType==="perNMinute"&&t("span",null,[e.minute,p.minute]),e.specType==="perNSecond"&&t("span",null,[e.second,p.second]),p.handle])}},{width:200,prop:"UpdatedAt",label:"更新时间",render(e){return new Date(e.row.UpdatedAt).toLocaleString()}},{width:200,prop:"CreatedAt",label:"创建时间",render(e){return new Date(e.row.CreatedAt).toLocaleString()}},{prop:"operation",label:"操作",fixed:"right",width:280}],f=h(),b=(e,m={})=>{var s,i;const u={title:e,rowData:{...m},api:e==="create"?B:P,getTableList:(s=y.value)==null?void 0:s.getTableList};(i=f.value)==null||i.acceptParams(u)},g=async e=>{await _(F,{id:e.ID},`删除【${e.name}】`),y.value.getTableList()},N=async e=>{await _(q,{ID:e},"执行一次"),y.value.getTableList()},$=async e=>{await _(j,{id:e.ID,status:e.status==="Enable"?"Disable":"Enable"},`更新【${e.name}】状态`),y.value.getTableList()};return(e,m)=>{const u=k("el-button");return v(),A("div",G,[t(R,{ref_key:"proTable",ref:y,title:"任务配置列表",indent:30,columns:D,"request-api":c(W)},{tableHeader:o(()=>[t(u,{type:"primary",icon:c(x),onClick:m[0]||(m[0]=s=>b("create"))},{default:o(()=>[a("新增任务")]),_:1},8,["icon"])]),operation:o(({row:s})=>[t(u,{type:"success",link:"",icon:c(E),onClick:i=>N(s.ID)},{default:o(()=>[a(" 执行 ")]),_:2},1032,["icon","onClick"]),t(u,{type:s.status==="Enable"?"danger":"primary",link:"",icon:s.status==="Enable"?c(L):c(S),onClick:i=>$(s)},{default:o(()=>[a(H(s.status==="Enable"?"禁用":"启用"),1)]),_:2},1032,["type","icon","onClick"]),t(u,{type:"success",link:"",icon:c(O),onClick:i=>b("edit",s)},{default:o(()=>[a(" 编辑 ")]),_:2},1032,["icon","onClick"]),t(u,{type:"danger",link:"",icon:c(I),onClick:i=>g(s)},{default:o(()=>[a(" 删除 ")]),_:2},1032,["icon","onClick"])]),_:1},8,["request-api"]),t(U,{ref_key:"DialogRef",ref:f},null,512)])}}});export{X as default};

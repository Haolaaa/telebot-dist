import{d as R,x as L,y as T,B as g,K as v,P as C,r,o as U,e as A,f as o,w as t,v as B,h as w,g as k,Q as z,R as E,J as K,S as M,T as q,U as I,V as $}from"./index-ce375fff.js";import{L as D}from"./user-c593abc4.js";import{u as H,a as J}from"./keepAlive-73069128.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";const P={class:"login-btn"},Q=R({__name:"LoginForm",setup(h){const y=L(),d=T(),b=H(),V=J(),u=g(),x=v({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),i=g(!1),n=v({username:"",password:""}),c=e=>{e&&e.validate(async s=>{if(s){i.value=!0;try{const{data:a}=await D({username:n.username,password:n.password});d.setToken(a.token),d.userInfo.name=a.user.nickName,await M(),b.closeMultipleTab(),V.setKeepAliveName(),y.push(q),I({title:$(),message:"欢迎登录 "+a.user.nickName,type:"success",duration:3e3})}finally{i.value=!1}}})},F=e=>{e&&e.resetFields()};return C(()=>{document.onkeydown=e=>{if(e=window.event||e,e.code==="Enter"||e.code==="enter"||e.code==="NumpadEnter"){if(i.value)return;c(u.value)}}}),(e,s)=>{const a=r("user"),m=r("el-icon"),p=r("el-input"),_=r("el-form-item"),N=r("lock"),S=r("el-form"),f=r("el-button");return U(),A(K,null,[o(S,{ref_key:"loginFormRef",ref:u,model:n,rules:x,size:"large"},{default:t(()=>[o(_,{prop:"username"},{default:t(()=>[o(p,{modelValue:n.username,"onUpdate:modelValue":s[0]||(s[0]=l=>n.username=l),placeholder:"请输入用户名"},{prefix:t(()=>[o(m,{class:"el-input__icon"},{default:t(()=>[o(a)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(_,{prop:"password"},{default:t(()=>[o(p,{modelValue:n.password,"onUpdate:modelValue":s[1]||(s[1]=l=>n.password=l),type:"password",placeholder:"请输入密码","show-password":"",autocomplete:"new-password"},{prefix:t(()=>[o(m,{class:"el-input__icon"},{default:t(()=>[o(N)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),B("div",P,[o(f,{icon:k(z),round:"",size:"large",onClick:s[2]||(s[2]=l=>F(u.value))},{default:t(()=>[w(" 重置 ")]),_:1},8,["icon"]),o(f,{icon:k(E),round:"",size:"large",type:"primary",loading:i.value,onClick:s[3]||(s[3]=l=>c(u.value))},{default:t(()=>[w(" 登录 ")]),_:1},8,["icon","loading"])])],64)}}});const Y=O(Q,[["__scopeId","data-v-82b05dc0"]]);export{Y as default};

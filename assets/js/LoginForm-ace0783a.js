import{d as L,J as R,$ as T,i as g,aa as v,a1 as C,r as a,o as A,c as E,b as o,w as t,a as U,e as w,u as k,P as z,ac as B,F as M,ad as $,T as q,E as I,ae as K}from"./index-5ddab338.js";import{L as D}from"./user-8b582e5d.js";import{u as H}from"./tabs-74cc25cf.js";import{u as J}from"./keepAlive-1896f361.js";import{_ as O}from"./_plugin-vue_export-helper-c27b6911.js";const P={class:"login-btn"},j=L({__name:"LoginForm",setup(G){const y=R(),d=T(),b=H(),F=J(),u=g(),V=v({username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]}),i=g(!1),n=v({username:"",password:""}),c=e=>{e&&e.validate(async s=>{if(s){i.value=!0;try{const{data:r}=await D({username:n.username,password:n.password});d.setToken(r.token),d.userInfo.name=r.user.nickName,await $(),b.closeMultipleTab(),F.setKeepAliveName(),y.push(q),I({title:K(),message:"欢迎登录 "+r.user.nickName,type:"success",duration:3e3})}finally{i.value=!1}}})},x=e=>{e&&e.resetFields()};return C(()=>{document.onkeydown=e=>{if(e=window.event||e,e.code==="Enter"||e.code==="enter"||e.code==="NumpadEnter"){if(i.value)return;c(u.value)}}}),(e,s)=>{const r=a("user"),m=a("el-icon"),p=a("el-input"),_=a("el-form-item"),N=a("lock"),S=a("el-form"),f=a("el-button");return A(),E(M,null,[o(S,{ref_key:"loginFormRef",ref:u,model:n,rules:V,size:"large"},{default:t(()=>[o(_,{prop:"username"},{default:t(()=>[o(p,{modelValue:n.username,"onUpdate:modelValue":s[0]||(s[0]=l=>n.username=l),placeholder:"请输入用户名"},{prefix:t(()=>[o(m,{class:"el-input__icon"},{default:t(()=>[o(r)]),_:1})]),_:1},8,["modelValue"])]),_:1}),o(_,{prop:"password"},{default:t(()=>[o(p,{modelValue:n.password,"onUpdate:modelValue":s[1]||(s[1]=l=>n.password=l),type:"password",placeholder:"请输入密码","show-password":"",autocomplete:"new-password"},{prefix:t(()=>[o(m,{class:"el-input__icon"},{default:t(()=>[o(N)]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"]),U("div",P,[o(f,{icon:k(z),round:"",size:"large",onClick:s[2]||(s[2]=l=>x(u.value))},{default:t(()=>[w(" 重置 ")]),_:1},8,["icon"]),o(f,{icon:k(B),round:"",size:"large",type:"primary",loading:i.value,onClick:s[3]||(s[3]=l=>c(u.value))},{default:t(()=>[w(" 登录 ")]),_:1},8,["icon","loading"])])],64)}}});const h=O(j,[["__scopeId","data-v-82b05dc0"]]);export{h as default};

import{d as v,B as r,r as f,o as b,i as x,w as l,f as i,h as p,g as T,a4 as A,a5 as C,a6 as N,O as h,a7 as V}from"./index-39a7af8f.js";const M=v({name:"Drawer"}),L=v({...M,setup(B,{expose:y}){const o=r(!1),n=r({authorityID:0}),_=e=>{n.value=e,o.value=!0,g()},c=r(),d=r([]),m=r([]),k=r({children:"children",label:e=>e.meta.title}),g=async()=>{try{d.value=[];const{data:e}=await C({page:1,pageSize:1e3});m.value=e.menus;const{data:t}=await N({authorityID:n.value.authorityID}),a=t.menus,u=[];a&&a.forEach(s=>{a.some(I=>Number(I.parentID)===s.ID)||u.push(Number(s.ID))}),d.value=u}catch{h.error({message:"获取菜单列表失败！"})}},w=(e,t)=>e?t.meta.title.indexOf(e)!==-1:!0,D=async()=>{try{if(!c.value)return;const e=c.value.getCheckedNodes(!1,!0),t=await V({menus:e,authorityId:n.value.authorityID});h.success({message:"设置权限成功！"}),n.value.getTableList(),o.value=!1}catch{}};return y({acceptParams:_}),(e,t)=>{const a=f("el-button"),u=f("el-drawer");return b(),x(u,{modelValue:o.value,"onUpdate:modelValue":t[1]||(t[1]=s=>o.value=s),"destroy-on-close":!0,size:"450px",title:"设置权限"},{footer:l(()=>[i(a,{onClick:t[0]||(t[0]=s=>o.value=!1)},{default:l(()=>[p("取消")]),_:1}),i(a,{type:"primary",onClick:D},{default:l(()=>[p("确定")]),_:1})]),default:l(()=>[i(T(A),{ref_key:"menuTree",ref:c,data:m.value,"default-checked-keys":d.value,props:k.value,"default-expand-all":"","highlight-current":"","node-key":"ID","show-checkbox":"","filter-node-method":w},null,8,["data","default-checked-keys","props","filter-node-method"])]),_:1},8,["modelValue"])}}});export{L as _};

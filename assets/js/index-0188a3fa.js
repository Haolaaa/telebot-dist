import{E as u,d as w,i as _,r as n,o as S,h as R,w as l,b as t,u as j,j as D,e as p,k as h,a as b,t as F,p as $,g as E,c as M}from"./index-99d0a915.js";import{_ as U}from"./_plugin-vue_export-helper-c27b6911.js";const N=async(a,d,r={},m=!0,o=".xlsx")=>{m&&u({title:"温馨提示",message:"如果数据庞大会导致下载缓慢哦，请您耐心等待！",type:"info",duration:3e3});try{const e=await a(r),f=new Blob([e]);if("msSaveOrOpenBlob"in navigator)return window.navigator.msSaveOrOpenBlob(f,d+o);const v=window.URL.createObjectURL(f),c=document.createElement("a");c.style.display="none",c.download=`${d}${o}`,c.href=v,document.body.appendChild(c),c.click(),document.body.removeChild(c),window.URL.revokeObjectURL(v)}catch{}},q=a=>($("data-v-6c0f1180"),a=a(),E(),a),P=q(()=>b("div",{class:"el-upload__text"},[p("将文件拖到此处，或"),b("em",null,"点击上传")],-1)),G={class:"el-upload__tip"},H=w({name:"ImportExcel"}),J=w({...H,setup(a,{expose:d}){const r=_(!1),m=_(1),o=_(!1),e=_({title:"",fileSize:5,fileType:["application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"]}),f=i=>{e.value={...e.value,...i},o.value=!0},v=()=>{e.value.tempApi&&N(e.value.tempApi,`${e.value.title}模板`)},c=async i=>{let s=new FormData;s.append("file",i.file),s.append("isCover",r.value),await e.value.importApi(s),e.value.getTableList&&e.value.getTableList(),o.value=!1},V=i=>{const s=e.value.fileType.includes(i.type),x=i.size/1024/1024<e.value.fileSize;return s||u({title:"温馨提示",message:"上传文件只能是 xls / xlsx 格式！",type:"warning"}),x||setTimeout(()=>{u({title:"温馨提示",message:`上传文件大小不能超过 ${e.value.fileSize}MB！`,type:"warning"})},0),s&&x},C=()=>{u({title:"温馨提示",message:"最多只能上传一个文件！",type:"warning"})},I=()=>{u({title:"温馨提示",message:`批量添加${e.value.title}失败，请您重新上传！`,type:"error"})},T=()=>{u({title:"温馨提示",message:`批量添加${e.value.title}成功！`,type:"success"})};return d({acceptParams:f}),(i,s)=>{const x=n("el-button"),y=n("el-form-item"),k=n("upload-filled"),A=n("el-icon"),B=n("el-upload"),L=n("el-switch"),z=n("el-form"),O=n("el-dialog");return S(),R(O,{modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=g=>o.value=g),title:`批量添加${e.value.title}`,"destroy-on-close":!0,width:"580px",draggable:""},{default:l(()=>[t(z,{class:"drawer-multiColumn-form","label-width":"100px"},{default:l(()=>[t(y,{label:"模板下载 :"},{default:l(()=>[t(x,{type:"primary",icon:j(D),onClick:v},{default:l(()=>[p(" 点击下载 ")]),_:1},8,["icon"])]),_:1}),t(y,{label:"文件上传 :"},{default:l(()=>[t(B,{action:"#",class:"upload",drag:!0,limit:m.value,multiple:!0,"show-file-list":!0,"http-request":c,"before-upload":V,"on-exceed":C,"on-success":T,"on-error":I,accept:e.value.fileType.join(",")},{tip:l(()=>[h(i.$slots,"tip",{},()=>[b("div",G,"请上传 .xls , .xlsx 标准格式文件，文件最大为 "+F(e.value.fileSize)+"M",1)],!0)]),default:l(()=>[h(i.$slots,"empty",{},()=>[t(A,{class:"el-icon--upload"},{default:l(()=>[t(k)]),_:1}),P],!0)]),_:3},8,["limit","accept"])]),_:3}),t(y,{label:"数据覆盖 :"},{default:l(()=>[t(L,{modelValue:r.value,"onUpdate:modelValue":s[0]||(s[0]=g=>r.value=g)},null,8,["modelValue"])]),_:1})]),_:3})]),_:3},8,["modelValue","title"])}}});const K=U(J,[["__scopeId","data-v-6c0f1180"]]),Q=a=>($("data-v-66f21c55"),a=a(),E(),a),W={class:"card content-box"},X=Q(()=>b("span",{class:"text"},"批量添加数据 🍓🍇🍈🍉",-1)),Y=w({name:"batchImport"}),Z=w({...Y,setup(a){const d=_();return(r,m)=>{const o=n("el-descriptions-item"),e=n("el-descriptions");return S(),M("div",W,[X,t(K,{ref_key:"importRef",ref:d},null,512),t(e,{title:"配置项（通过 ref 传递） 📚",column:1,border:""},{default:l(()=>[t(o,{label:"title"},{default:l(()=>[p(" 组件显示标题 && 上传成功之后提示信息 ")]),_:1}),t(o,{label:"fileSize"},{default:l(()=>[p(" 上传文件大小，默认为 5M ")]),_:1}),t(o,{label:"fileType"},{default:l(()=>[p(' 上传文件类型限制，默认类型为 ["application/vnd.ms-excel", "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"] ')]),_:1}),t(o,{label:"tempApi"},{default:l(()=>[p(" 下载模板的 Api ")]),_:1}),t(o,{label:"importApi"},{default:l(()=>[p(" 上传数据的 Api ")]),_:1}),t(o,{label:"getTableList"},{default:l(()=>[p(" 上传数据成功之后，刷新表格数据的 Api ")]),_:1})]),_:1})])}}});const le=U(Z,[["__scopeId","data-v-66f21c55"]]);export{le as default};
